<!DOCTYPE html>

<body>
  <style>
    body {
      background: #151517;
      box-sizing: border-box;
      border-radius: 8px;
      font-family: sans-serif;
      -webkit-font-smoothing: antialiased;
      color: #efeaea;
      transition:
        background-color 0.4s,
        color 0.4s;
    }

    ::-webkit-scrollbar {
      width: 7px;
      height: 7px;
    }

    ::-webkit-scrollbar-track {
      background: #151517;
    }

    ::-webkit-scrollbar-thumb {
      background: #727272;
    }

    #bar {
      backdrop-filter: blur(64px);
      -webkit-app-region: drag;
      padding: 0;
      border-top-left-radius: 4px;
      border-top-right-radius: 4px;
      color: #b0d944;
      white-space: nowrap;
      box-sizing: border-box;
      position: fixed;
      z-index: 100;
      width: 100%;
      left: 0;
      top: 0;
    }

    #bar:hover {
      outline: #b0d944;
    }

    pear-ctrl {
      margin-top: 9px;
    }

    pear-ctrl[data-platform='darwin'] {
      margin-top: 16px;
      margin-left: 8px;
    }

  </style>
  <div id="bar"><pear-ctrl></pear-ctrl></div>
  <pear-links></pear-links>
  <script>
    class PearLinks extends HTMLElement {
      constructor() {
        super();
        this.attachShadow({mode: 'open'});
        this.shadowRoot.innerHTML = `
          <style>
            ul {
              list-style-type: none;
              display: none;
            }
            ul.enabled {
              display: block;
            }
            li {
              margin-bottom: 1em;
            }
            div {
              margin-bottom: 1em;
            }
            input[type="text"] {
              width: 400px;
            }
            .app-key-input-container {
              padding-left: 40px;
              margin-top: 4em;
              margin-bottom: 2em;
            }

            a:link,
            a:visited,
            a:hover,
            a:active,
            a {
              color: #b0d944;
            }
          </style>
          <div class="app-key-input-container">
            <h3>Nurse</h3>
            <label for="app-key"><strong>Enter Doctor &lt;app-key&gt;: </strong></label>
            <input type="text" id="app-key" name="app-key" />
          </div>
          <div>
            <ul id="link-list">
              <li>
                <strong>Link:</strong>
                <a id="link1" href="#">pear://&lt;app-key&gt;</a>
              </li>
              <li>
                <strong>Fragment:</strong>
                <a id="link2" href="#">pear://&lt;app-key&gt;/#fragment</a>
              </li>
              <li>
                <strong>Entrypoint:</strong>
                <a id="link3" href="#">pear://&lt;app-key&gt;/nested/entrypoint.html</a>
              </li>
              <li>
                <strong>Entrypoint fragment:</strong>
                <a id="link4" href="#">pear://&lt;app-key&gt;/nested/entrypoint.html#fragment</a>
              </li>
              <li>
                <strong>Legacy invite code:</strong>
                <a id="link5" href="#">pear://&lt;app-key&gt;/xeb7mugj8s...</a>
              </li>
            </ul>
          </div>
        `;

        this.shadowRoot.querySelector('#app-key').addEventListener('input', this.updateLinks.bind(this));
      }

      updateLinks(event) {
        const appKey = event.target.value;
        const linkList = this.shadowRoot.querySelector('#link-list');

        if (appKey.trim() !== "") {
          linkList.classList.add('enabled');
        } else {
          linkList.classList.remove('enabled');
        }

        this.shadowRoot.querySelector('#link1').href = `pear://${appKey}`;
        this.shadowRoot.querySelector('#link2').href = `pear://${appKey}/#fragment`;
        this.shadowRoot.querySelector('#link3').href = `pear://${appKey}/nested/entrypoint.html`;
        this.shadowRoot.querySelector('#link4').href = `pear://${appKey}/nested/entrypoint.html#fragment`;
        this.shadowRoot.querySelector('#link5').href = `pear://${appKey}/xeb7mugj8sbaytkf5qqu9z1snegtibqneysssdqu35em4zw3ou9wcmz8ha4er6e759tams9eeebo6j6ueifyb4oaeohnijbyxfzessxjneaqs8ux`;
      }
    }

    customElements.define('pear-links', PearLinks);
  </script>
</body>

</html>
